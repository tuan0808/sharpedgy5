<!-- Header -->
<header class="header">
    <div class="header-content">
        <div class="logo">SportAlert Pro</div>
        <div class="header-actions">
            <button class="notification-badge" (click)="toggleNotifications()">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
                    <path d="M12 22c1.1 0 2-.9 2-2h-4c0 1.1.9 2 2 2zm6-6v-5c0-3.07-1.64-5.64-4.5-6.32V4c0-.83-.67-1.5-1.5-1.5s-1.5.67-1.5 1.5v.68C7.63 5.36 6 7.92 6 11v5l-2 2v1h16v-1l-2-2z"/>
                </svg>
                <span class="notification-count">{{ notificationCount }}</span>
            </button>
            <button class="btn btn-secondary" (click)="openSettings()">Settings</button>
        </div>
    </div>
</header>

<!-- Main Content -->
<div class="container">
    <!-- Stats Section -->
    <section class="section">
        <div class="stats-grid">
            <div class="stat-card" *ngFor="let stat of stats">
                <div class="stat-header">
                    <div>
                        <div class="stat-value">{{ stat.value }}</div>
                        <div class="stat-label">{{ stat.label }}</div>
                        <div class="stat-change" [ngClass]="stat.trend" *ngIf="stat.change">
                            <svg width="12" height="12" viewBox="0 0 24 24" fill="currentColor" *ngIf="stat.trend === 'positive'">
                                <path d="M7 14l5-5 5 5z"/>
                            </svg>
                            <svg width="12" height="12" viewBox="0 0 24 24" fill="currentColor" *ngIf="stat.trend === 'negative'">
                                <path d="M7 10l5 5 5-5z"/>
                            </svg>
                            {{ stat.change }}
                        </div>
                    </div>
                    <div class="stat-icon" [ngClass]="stat.iconType">
                        <div [innerHTML]="stat.icon"></div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Games Section -->
    <section class="section">
        <div class="games-container">
            <div class="games-header">
                <div class="section-header">
                    <h2 class="section-title">Live & Upcoming Games</h2>
                    <button class="btn btn-primary" (click)="openNotificationCreator()">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
                            <path d="M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z"/>
                        </svg>
                        Create Alert
                    </button>
                </div>
            </div>

            <div class="games-list">
                <div class="game-card" *ngFor="let game of games">
                    <div class="game-meta">
                        <div class="league-info">
                            <span>{{ game.leagueIcon }}</span>
                            <span>{{ game.league }}</span>
                        </div>
                        <div class="game-status" [ngClass]="'status-' + game.status">{{ game.statusText }}</div>
                    </div>

                    <div class="matchup">
                        <div class="team away">
                            <div class="team-logo">{{ game.awayTeam.abbreviation }}</div>
                            <div class="team-details">
                                <h3>{{ game.awayTeam.name }}</h3>
                                <div class="team-record">{{ game.awayTeam.record }}</div>
                            </div>
                        </div>

                        <div class="score-section">
                            <div class="score" *ngIf="game.awayTeam.score !== undefined && game.homeTeam.score !== undefined">
                                {{ game.awayTeam.score }} - {{ game.homeTeam.score }}
                            </div>
                            <div class="score" *ngIf="game.awayTeam.score === undefined">vs</div>
                            <div class="vs-text">{{ game.statusText }}</div>
                        </div>

                        <div class="team home">
                            <div class="team-logo">{{ game.homeTeam.abbreviation }}</div>
                            <div class="team-details">
                                <h3>{{ game.homeTeam.name }}</h3>
                                <div class="team-record">{{ game.homeTeam.record }}</div>
                            </div>
                        </div>
                    </div>

                    <div class="game-info">
                        <div class="info-block">
                            <h4>Betting Lines</h4>
                            <div class="betting-lines">
                                <div class="line-row" *ngFor="let line of game.bettingLines">
                                    <span class="line-label">{{ line.label }}</span>
                                    <span class="line-value">
                    {{ line.value }}
                                        <span
                                                class="line-movement"
                                                [ngClass]="'movement-' + line.movement?.direction"
                                                *ngIf="line.movement"
                                        >
                      {{ line.movement.direction === 'up' ? '↑' : '↓' }}{{ line.movement.amount }}
                    </span>
                  </span>
                                </div>
                            </div>
                        </div>

                        <div class="info-block" *ngIf="game.weather">
                            <h4>Weather</h4>
                            <div>{{ game.weather }}</div>
                        </div>

                        <div class="info-block" *ngIf="game.injuries">
                            <h4>Key Injuries</h4>
                            <div>{{ game.injuries }}</div>
                        </div>
                    </div>

                    <div class="alerts-section">
                        <div class="alerts-label">Alert Settings</div>
                        <div class="alert-tags">
              <span
                      *ngFor="let alert of game.alerts"
                      class="alert-tag"
                      [ngClass]="{ 'active': game.activeAlerts.includes(alert) }"
                      (click)="toggleAlert(game.id, alert)"
              >
                {{ alert }}
              </span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>
</div>

<!-- Live Updates Panel -->
<div class="live-panel" *ngIf="showLivePanel">
    <div class="live-header">
        <div class="live-title">
            <div class="live-indicator"></div>
            <span>Live Updates</span>
        </div>
        <button class="close-button" (click)="closeLivePanel()">×</button>
    </div>
    <div class="updates-list">
        <div class="update-item" *ngFor="let update of liveUpdates">
            <div class="update-header">
                <span class="update-time">{{ update.time }}</span>
                <span class="update-category">{{ update.category }}</span>
            </div>
            <div class="update-text">{{ update.text }}</div>
        </div>
    </div>
</div>

<!-- Modal -->
<div class="modal-overlay" [style.display]="showModal ? 'flex' : 'none'" (click)="closeModal($event)">
    <div class="modal">
        <div class="modal-header">
            <h2 class="modal-title">{{ modalTitle }}</h2>
            <button class="close-button" (click)="closeModal()">&times;</button>
        </div>
        <div class="modal-body">
            <ng-container [ngSwitch]="modalType">
                <!-- Notification Creator -->
                <div *ngSwitchCase="'notification-creator'">
                    <!-- Step 1: Select Game -->
                    <div class="wizard-step" [ngClass]="{ 'active': currentStep === 1 }">
                        <div class="step-header">
                            <h3 class="step-title">Select Game or Team</h3>
                            <p class="step-description">Choose a specific game or follow a team for ongoing alerts</p>
                        </div>

                        <div class="form-group">
                            <label class="form-label">Search Games</label>
                            <input
                                    type="text"
                                    class="form-control"
                                    placeholder="Search teams, leagues, or games..."
                                    [(ngModel)]="gameSearchQuery"
                                    (input)="filterGames()"
                            >
                        </div>

                        <div class="selection-grid">
                            <div
                                    class="selection-card"
                                    *ngFor="let game of filteredGames"
                                    [ngClass]="{ 'selected': selectedGame === game.id }"
                                    (click)="selectGame(game.id)"
                            >
                                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 8px;">
                                    <span style="font-size: 14px; font-weight: 500;">{{ game.leagueIcon }} {{ game.league }}</span>
                                    <span
                                            style="font-size: 11px; padding: 4px 8px; border-radius: 12px; font-weight: 600;"
                                            [ngClass]="'status-' + game.status"
                                    >
                    {{ game.status.toUpperCase() }}
                  </span>
                                </div>
                                <div class="card-title">{{ game.awayTeam.name }} @ {{ game.homeTeam.name }}</div>
                                <div class="card-description">{{ game.statusText }}</div>
                            </div>
                        </div>

                        <div class="wizard-navigation">
                            <div></div>
                            <button class="btn btn-primary" [disabled]="!selectedGame" (click)="nextStep()">Next</button>
                        </div>
                    </div>

                    <!-- Step 2: Choose Alert Type -->
                    <div class="wizard-step" [ngClass]="{ 'active': currentStep === 2 }">
                        <div class="step-header">
                            <h3 class="step-title">Choose Alert Type</h3>
                            <p class="step-description">Select the type of notifications you want to receive</p>
                        </div>

                        <div class="selection-grid">
                            <div
                                    class="selection-card"
                                    *ngFor="let alertType of alertTypes"
                                    [ngClass]="{ 'selected': selectedAlertType === alertType.id }"
                                    (click)="selectAlertType(alertType.id)"
                            >
                                <span class="card-icon">{{ alertType.icon }}</span>
                                <div class="card-title">{{ alertType.title }}</div>
                                <div class="card-description">{{ alertType.description }}</div>
                            </div>
                        </div>

                        <div class="wizard-navigation">
                            <button class="btn btn-secondary" (click)="previousStep()">← Back</button>
                            <button class="btn btn-primary" [disabled]="!selectedAlertType" (click)="createNotification()">Create Alert</button>
                        </div>
                    </div>
                </div>

                <!-- Settings -->
                <div *ngSwitchCase="'settings'">
                    <div class="form-group">
                        <label class="form-label">Notification Preferences</label>
                        <div style="display: flex; flex-direction: column; gap: 12px;">
                            <label style="display: flex; align-items: center; gap: 8px;">
                                <input type="checkbox" [(ngModel)]="settings.browserNotifications">
                                Browser notifications
                            </label>
                            <label style="display: flex; align-items: center; gap: 8px;">
                                <input type="checkbox" [(ngModel)]="settings.emailNotifications">
                                Email notifications
                            </label>
                            <label style="display: flex; align-items: center; gap: 8px;">
                                <input type="checkbox" [(ngModel)]="settings.soundEnabled">
                                Sound alerts
                            </label>
                        </div>
                    </div>

                    <div class="form-group">
                        <label class="form-label">Quiet Hours</label>
                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 12px;">
                            <input type="time" class="form-control" [(ngModel)]="settings.quietHoursStart">
                            <input type="time" class="form-control" [(ngModel)]="settings.quietHoursEnd">
                        </div>
                    </div>

                    <div style="display: flex; justify-content: flex-end; gap: 12px; margin-top: 24px;">
                        <button class="btn btn-secondary" (click)="closeModal()">Cancel</button>
                        <button class="btn btn-primary" (click)="saveSettings()">Save Settings</button>
                    </div>
                </div>
            </ng-container>
        </div>
    </div>
</div>
