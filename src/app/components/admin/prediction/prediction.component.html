<div class="container max-w-3xl mx-auto p-6 bg-white rounded-lg shadow">
    <h2 class="text-2xl font-bold mb-6 text-gray-800">Submit Game Prediction & Betting Analysis</h2>

    <div *ngIf="errorMessage" class="mb-4 p-3 bg-red-100 border border-red-400 text-red-700 rounded">
        {{errorMessage}}
    </div>

    <div *ngIf="submitSuccess" class="mb-4 p-3 bg-green-100 border border-green-400 text-green-700 rounded">
        Prediction and betting analysis submitted successfully!
    </div>

    <form (ngSubmit)="handleSubmit($event)">
        <div class="mb-4">
            <label for="gameSelect" class="block text-gray-700 font-medium mb-2">
                Select Game <span class="text-red-500">*</span>
            </label>
            <select
                    id="gameSelect"
                    [(ngModel)]="formData.gameId"
                    name="gameId"
                    class="form-select w-full p-3 border rounded"
                    required>
                <option value="">-- Select a Game --</option>
                <option *ngFor="let game of upcomingGames" [value]="game.id">
                    {{game.league}}: {{game.homeTeam}} vs {{game.awayTeam}} - {{formatGameTime(game.gameTime)}}
                </option>
            </select>
        </div>

        <div *ngIf="getSelectedGame()">
            <div class="mb-6 p-4 bg-light rounded border">
                <div class="d-flex justify-content-between align-items-center mb-4">
                    <div class="text-center flex-1">
                        <div class="font-semibold text-lg">{{getSelectedGame()?.homeTeam}}</div>
                        <div class="text-xs text-gray-500">(Home)</div>
                    </div>
                    <div class="mx-4 text-gray-500 font-bold">VS</div>
                    <div class="text-center flex-1">
                        <div class="font-semibold text-lg">{{getSelectedGame()?.awayTeam}}</div>
                        <div class="text-xs text-gray-500">(Away)</div>
                    </div>
                </div>

                <div class="mb-4">
                    <label class="block text-gray-700 font-medium mb-2">
                        Predicted Winner <span class="text-red-500">*</span>
                    </label>
                    <div class="d-flex gap-3">
                        <div class="form-check">
                            <input
                                    type="radio"
                                    id="homeTeamWin"
                                    [(ngModel)]="formData.predictedWinner"
                                    name="predictedWinner"
                                    [value]="getSelectedGame()?.homeTeam"
                                    class="form-check-input"
                                    required>
                            <label for="homeTeamWin" class="form-check-label text-gray-700">
                                {{getSelectedGame()?.homeTeam}} (Home)
                            </label>
                        </div>
                        <div class="form-check">
                            <input
                                    type="radio"
                                    id="awayTeamWin"
                                    [(ngModel)]="formData.predictedWinner"
                                    name="predictedWinner"
                                    [value]="getSelectedGame()?.awayTeam"
                                    class="form-check-input">
                            <label for="awayTeamWin" class="form-check-label text-gray-700">
                                {{getSelectedGame()?.awayTeam}} (Away)
                            </label>
                        </div>
                    </div>
                </div>

                <div class="mb-4">
                    <label for="confidenceSelect" class="block text-gray-700 font-medium mb-2">
                        Confidence Level <span class="text-red-500">*</span>
                    </label>
                    <select
                            id="confidenceSelect"
                            [(ngModel)]="formData.confidence"
                            name="confidence"
                            class="form-select w-full p-3 border rounded"
                            required>
                        <option *ngFor="let level of confidenceLevels" [value]="level.value">
                            {{level.label}}
                        </option>
                    </select>
                </div>
            </div>

            <div class="mb-6">
                <h3 class="text-lg font-semibold mb-4 text-gray-700">Betting Information</h3>

                <div class="row g-4 mb-4">
                    <div class="col-md-6">
                        <label for="oddsHomeTeam" class="block text-gray-700 font-medium mb-2">
                            Moneyline Odds - {{getSelectedGame()?.homeTeam}}
                        </label>
                        <input
                                type="text"
                                id="oddsHomeTeam"
                                [(ngModel)]="formData.oddsHomeTeam"
                                name="oddsHomeTeam"
                                placeholder="+120"
                                class="form-control">
                    </div>
                    <div class="col-md-6">
                        <label for="oddsAwayTeam" class="block text-gray-700 font-medium mb-2">
                            Moneyline Odds - {{getSelectedGame()?.awayTeam}}
                        </label>
                        <input
                                type="text"
                                id="oddsAwayTeam"
                                [(ngModel)]="formData.oddsAwayTeam"
                                name="oddsAwayTeam"
                                placeholder="-140"
                                class="form-control">
                    </div>
                </div>

                <div class="row g-4 mb-4">
                    <div class="col-md-6">
                        <label for="spreadFavorite" class="block text-gray-700 font-medium mb-2">
                            Spread Favorite
                        </label>
                        <select
                                id="spreadFavorite"
                                [(ngModel)]="formData.spreadFavorite"
                                name="spreadFavorite"
                                class="form-select">
                            <option value="">-- Select Team --</option>
                            <option [value]="getSelectedGame()?.homeTeam">{{getSelectedGame()?.homeTeam}}</option>
                            <option [value]="getSelectedGame()?.awayTeam">{{getSelectedGame()?.awayTeam}}</option>
                        </select>
                    </div>
                    <div class="col-md-6">
                        <label for="spreadPoints" class="block text-gray-700 font-medium mb-2">
                            Spread Points
                        </label>
                        <input
                                type="text"
                                id="spreadPoints"
                                [(ngModel)]="formData.spreadPoints"
                                name="spreadPoints"
                                placeholder="5.5"
                                class="form-control">
                    </div>
                </div>

                <div class="mb-4">
                    <label for="overUnderTotal" class="block text-gray-700 font-medium mb-2">
                        Over/Under Total
                    </label>
                    <input
                            type="text"
                            id="overUnderTotal"
                            [(ngModel)]="formData.overUnderTotal"
                            name="overUnderTotal"
                            placeholder="224.5"
                            class="form-control">
                </div>

                <div class="mb-4">
                    <label for="recommendedBet" class="block text-gray-700 font-medium mb-2">
                        Recommended Bet
                    </label>
                    <select
                            id="recommendedBet"
                            [(ngModel)]="formData.recommendedBet"
                            name="recommendedBet"
                            class="form-select">
                        <option value="">-- Select Recommended Bet --</option>
                        <option *ngFor="let option of recommendedBetOptions" [value]="option.value">
                            {{option.label}}
                        </option>
                    </select>
                </div>
            </div>

            <div class="mb-6">
                <label for="analysisTextarea" class="block text-gray-700 font-medium mb-2">
                    Analysis & Reasoning <span class="text-red-500">*</span>
                </label>
                <textarea
                        id="analysisTextarea"
                        [(ngModel)]="formData.analysis"
                        name="analysis"
                        rows="6"
                        placeholder="Provide your in-depth analysis for this prediction..."
                        class="form-control"
                        required
                        minlength="20"></textarea>
                <div class="text-muted small mt-1">
                    {{formData.analysis.length}}/2000 characters
                </div>
            </div>

            <div class="d-flex gap-3">
                <button
                        type="submit"
                        class="btn btn-primary d-flex align-items-center"
                        [disabled]="isSubmitting">
                    <span *ngIf="isSubmitting" class="spinner-border spinner-border-sm me-2"></span>
                    Submit Prediction Analysis
                </button>
                <button
                        type="button"
                        (click)="resetForm()"
                        class="btn btn-secondary">
                    Reset
                </button>
            </div>
        </div>
    </form>
</div>
